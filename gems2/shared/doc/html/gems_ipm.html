<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR"
 content="Mozilla/4.72 [en] (Win98; I) [Netscape]">
  <title>GEMS IPM Submodule Manual</title>
  <meta name="description" content="Version 2.0.0-PSI">
</head>
<body>
<h1><img src="gems1.png" align="left" height="48" width="48"> <font
 color="#000066"> GEM-Selektor version 2-PSI</font></h1>
<p> </p>
<h2> GEM IPM Submodule Manual</h2>
<hr size="2" width="100%">
<h3>Contents </h3>
<blockquote>
  <p><font face="Helvetica, Arial, sans-serif"><a href="#MULTI_INTRO">1.
The MULTI data structure and GEM IPM calculation of equilibrium states</a>
  </font></p>
  <p><font face="Helvetica, Arial, sans-serif"><a href="#GEM_IPM_INTRO">2.
The GEM IPM-2 Algorithm</a> </font></p>
  <p><a href="#IPM_CONTROLS"><font face="Helvetica, Arial, sans-serif">3.
Data Entries to Control IPM Algorithm Operation</font></a></p>
  <p><a href="#IPM_ERRORS"><font face="Helvetica, Arial, sans-serif">4.
Warnings and Error Messages</font></a>&nbsp;</p>
</blockquote>
<hr size="2" width="100%">
<p> </p>
<h2><a name="MULTI_INTRO"></a>1. The MULTI data structure and GEM IPM
calculation of equilibrium states<br>
</h2>
<br>
This data structure is not stored in database; it is automatically
created in the dynamic program memory when you press a "GEM IPM" button
on the "Single Thermodynamic System" dialog or start a <a
 href="gm_proces.html">Process simulation</a> calculation. The MULTI
structure is filled out using data and configuration flags from the <a
 href="gm_project.html">Project System data structure</a>. First,
thermodynamic data are recalcuated for the whole system profile if
temperature or pressure have changed. Second, the program goes through
the component and species selection switches in the <a
 href="gems_bcc.html">Project System CSD part</a>&nbsp;<a
 href="file:///C:/gems2html/program/doc/html/gp_howto.html#P344S"></a>and
takes into the MULTI structure only phases and species that were not
switched off. Third, math scripts for the involved non-ideal phases
are pre-processed, translated and stored into work arrays.
Thermodynamic data are normalized and copied into MULTI vectors <a
 href="gems_sys.html#g0"><tt>g0</tt></a> and <tt><a
 href="gems_sys.html#v0">v0</a></tt> according to selected species
only.. If the equilibrium state for this system has already been
calculated then the respective SysEq record will be unpacked&nbsp; into
the <a href="gems_sys.html#x"><tt>x</tt></a> and <a
 href="gems_sys.html#lnGam"><tt>lnGam </tt></a>vectors to be
(optionally) used as a non-automatic initial approximation for the GEM
IPM-2 algorithm.&nbsp; If sorption phases are present in the system
then all necessary conversions of surface type parameters are
performed as well. <br>
<br>
When the MULTI data structure is completely loaded, the GEM IPM-2
calculation will be performed, as described in detail in publications
[Karpov et al., 1997; 2001] and in the unpublished report [Chudnenko et
al. 2002] available as a PDF file on the GEM-Selektor v.2-PSI web site.
This manual (see below) describes the data objects that control
operation of GEM IPM-2 high-precision algorithm. The output
(equilibrium speciation etc.) data objects are described in the <a
 href="gems_sys.html">gems-sys.html</a> and<a href="gems_scm.html">
gems_scm.html</a> manuals.&nbsp;
<p><br>
</p>
<hr size="2" width="100%">
<h2><a name="GEM_IPM_INTRO"></a> 2. The GEM IPM-2 Algorithm </h2>
<p>In short, operation of the GEM IPM-2 module proceeds as follows. <br>
</p>
<p>The Simplex initial approximation is computed (if specified e.g. in
the "Calculate" "Simplex" menu command of the Single Thermodynamic
System dialog). There are two controls - <a href="#Pa_EPS_0"><tt>Pa_EPS[0]</tt></a>
and <a href="#Pa_GAN_0"><tt>Pa_GAN</tt></a> - that influence precision
and result of the Simplex calculation, respectively. <br>
</p>
<p>Next, the FIADE() procedure for entering the IPM feasible domain is
executed (IPM algorithm faults rarely, but most often in this place).
This step is most sensitive to several controls - <tt><a href="#Pa_DHB">Pa_DHB</a>,<a
 href="#Pa_DFY_0">Pa_DFY</a>, <a href="#Pa_GAN_2">Pa_GAN[2]</a>, <a
 href="#Pa_DPV_0">Pa_DPV</a></tt> - which define the quality of IPM
results.&nbsp;</p>
<p>Upon successful return from FIADE(), the main loops of IPM
iterations begin; the minimization problem is considered as solved when
the calculated value of Dikin's convergence criterion CD becomes
smaller than the <a href="#Pa_DK"><tt>Pa_DK</tt></a> threshold and the
maximum allowed total number of IPM iterations <a href="#Pa_IIM"><tt>Pa_IIM</tt></a>
is not yet reached. At each IPM iteration, the GammaCalc() module is
executed to update activity coefficients (and Coulombic terms for
electrostatic sorption models). If math scripts are used in some phase
definitions, they are calculated within the GammaCalc() procedure,
which is controlled by <tt><a href="#Pa_AG">Pa_AG</a>, <a
 href="#Pa_DGC">Pa_DGC</a>, <a href="#Pa_PRD_0">Pa_PRD</a></tt>
values.
In the course of IPM iterations, some phases and components can be
eliminated if their quantities become smaller than the respective
thresholds in <a href="#Pa_DS"><tt>Pa_DS</tt></a> and <a
 href="#Pa_XMI_0"><tt>Pa_XMI</tt></a> fields. Changing these fields can
greatly affect convergence and final result of IPM calculations, and
therefore is not recommended for novices. <br>
</p>
<p>After convergence of the main IPM loops, the control goes to
PhaseSelect() (Selekt2()) procedure that calculates Karpov's stability
criteria for all species and phases, including eliminated ones, and
checks if some phases have been lost and must be restored in the x and
Xa vectors. If this is the case, the control will go back to FIADE{} up
to three times. Behavior of PhaseSelect() depends on the <a
 href="#Pa_PC"><tt>Pa_PC</tt></a> and <a href="#Pa_DF_0"><tt>Pa_DF</tt></a>
controls. In addition, at this step, the mass balance precision of the
IPM result is analyzed using the <tt><a href="#Pa_DHB">Pa_DHB</a>, <a
 href="#Pa_GAN_0">Pa_GAN</a>, <a href="#Pa_DPV_0">Pa_DPV</a></tt> and <a
 href="#Pa_LLG"><tt>Pa_LLG</tt></a> controls; if necessary, the
precision criteria for FIADE() are corrected and the control sent back
to FIADE() up to 15 times in total. <br>
</p>
<p>When the whole IPM-2 sequence has converged and the user has pressed
"Accept" button, the MULTI structure remains intact in the memory, only
the results will be automatically packed and saved into a SysEq
database record.<br>
&nbsp; <br>
&nbsp; &nbsp; </p>
<hr size="2" width="100%">
<h2><a name="IPM_CONTROLS"></a>3. Data Entries to Control IPM Algorithm
Operation</h2>
<p> The data objects listed below control the operation of enhanced GEM
IPM-2 module. They are saved in GEMS database as part of the modelling
project record and can be changed any time in the "Calculation of
Equilibria" mode. To access GEM IPM controls, open your modelling
project and get into the "Gibbs Energy Minimization Modelling Project"
dialog; there, click on the "Numerical Controls..." button, which will
open the Param 1 page of the "Project" module window. If you will&nbsp;
change any field there but not save the Project record, then your
changes will apply only until the project is closed (then the changes
will be lost). If you wish the changes to persist then save the Project
record to database by clicking on the "Save" toolbar button (or
"Record" "Save" menu command). </p>
<p><b>Note that in most cases, there is no need to change default
values of any of parameters listed below because these were found from
an immense computational experience. Changing the IPM numerical
controls without proper experience and knowledge, especially setting
their values beyond the indicated intervals of possible values, may
cause the program to crash, freese or produce meaningless
results.&nbsp; </b></p>
<br>
<br>
<dl>
  <dt> <a name="Pa_DB"></a><big><b><big><tt>Pa_DB</tt></big></b></big>
-
Cutoff mole quantity for elimination of Independent Components from the
b vector { 1e-17 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This cutoff level is used in calculation of stoichiometric basis
and bulk chemical composition (vector <a href="gems_sys.html#b"><tt>b</tt></a>)
of the chemical system to be solved using the GEM IPM module. If
calculated number of moles of an i-th Independent Component <i>b<sub>i</sub></i>
&nbsp;is less than <tt>Pa_DB</tt>, then such IC will be automatically
excluded from system definition which will be compressed
accordingly.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Possible <tt>Pa_DB</tt> values: 1e-6 to 1e-18, default 1e-17
mol.&nbsp; </dd>
  <dd>&nbsp;</dd>
  <dd> <br>
  </dd>
  <dt> <a name="Pa_DS"></a><big><b><big><tt>Pa_DS</tt></big></b></big>
-
Cutoff mole quantity for the elimination of phases at IPM iterations {
1e-12 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>The IPM algorithm will automatically zero off any phase and all
its species in the x vector (primal solution) if current total number
of moles in the phase becomes less than the <tt>Pa_DS</tt> cutoff
value. <br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>Possible values: 1e-6 to 1e-17 mol, recommended is 1e-10 mol,
default is 1e-12 mol.&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>The IPM elimination criteria for special cases (multicomponent
phases of different kinds and their species) are given in the <tt>Pa_XMI</tt>&nbsp;
fields described below.</dd>
  <dd>&nbsp;&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_XMI_0"></a><big><b><tt>Pa_XMI[0]</tt></b></big> -
Cutoff mole quantity of water-solvent for aqueous phase elimination{
1e-5 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_XMI_1"></a><big><b><tt>Pa_XMI[1]</tt></b></big>
-&nbsp;Cutoff mole quantity of solid sorbent&nbsp; for sorption phase
elimination { 1e-7 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_XMI_2"></a><b><big><tt>Pa_XMI[2]</tt></big></b> -
Cutoff mole quantity for elimination of solute (sorbate) species {
1e-20 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This value defines the important <i>L<sub>S</sub></i>&nbsp; set
of dependent components in solution phases (see Karpov et al.,
1997).&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Possible values: 1e-16 to 1e-22, &nbsp;default 1e-20 moles.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_XMI_3"></a><big><b><tt>Pa_XMI[3]</tt></b></big> -
Cutoff mole quantity for elimination of solution phases other than
aqueous { 1e-10 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_XMI_4"></a><b><big><tt>Pa_XMI[4]</tt></big></b> -
Cutoff value of effective molal ionic strength to disable aq-gamma
calculation { 1e-5 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Calculation of activity coefficients of aqueous phase species in
GammaCalc() procedure is preformed only&nbsp;</dd>
  <dd>if the effective molal ionic strength exceeds this cutoff value,
otherwise, the activity coefficients will be set to 1.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_DHB"></a><big><big><b><tt>Pa_DHB</tt></b></big></big>
- Generic precision tolerance for IC mass balance residuals in
FIADE-1(), mol/kg of the system { 1e-8 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This control defines an absolute value of mass balance residuals
for all independent components that must be satisfied when entering the
IPM feasible domain before starting the main cycle of IPM descent
iterations. Actually, Pa_DHB is the convergence criterion for the first
stage of IPM.&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>Possible values: 1e-4 to 1e-10, 1e-8 mol/kg recommended.&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>Internally, the <tt>DHBM</tt> criterion is used in FIADE()
calculations, which contains the <tt>Pa_DHB</tt> value automatically
corrected for the total mass or number of moles in the system.
Inconsistent thermodynamic data may require to increase Pa_DHB,
otherwise the feasible IPM domain cannot be entered. If this happens
then the definition of chemical system is most probably wrong and must
be reconsidered, or there are crude (e.g. species stoichiometry or
valence) errors in the project thermodynamic database.&nbsp; </dd>
  <dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DFY_0"></a><b><big><tt>Pa_DFY[0]</tt></big></b> -
Insertion mole quantity for water-solvent at Simplex()-&gt;FIADE()
bridge { 1e-6 }</dt>
  <dd>&nbsp; &nbsp;&nbsp;</dd>
  <dd>This and following controls are used in a "fill-out" procedure
converting the Simplex initial approximation of the primal vector y
into a "raw" feasible approximation to be improved by the FIADE-1()
procedure. This must be done because in Simplex solution, each
dependent component is represented as a separate phase and the number
of non-zero phase quantities cannot exceed the number of independent
components. In a real chemical multisystem containing aqueous and other
multicomponent phases, much more dependent components may be present in
positive quantities at equilibrium. Hence, the program checks each j-th
value in the y vector whether <i>y<sub>j</sub></i> &nbsp;is greater
than the respective Pa_DFY quantity; if not, then&nbsp; <i>y<sub>j</sub>
&nbsp;</i>is assigned this quantity in the FIADE-1() input.&nbsp; <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_DFY_1"></a><b><big><tt>Pa_DFY[1]</tt></big></b>
&nbsp;- Insertion mole quantity for aqueous species at
Simplex()-&gt;FIADE() bridge { 1e-6 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DFY_2"></a><b><big><tt>Pa_DFY[2]</tt></big></b>
-&nbsp;Insertion mole quantity for species of ideal solutions at
Simplex()-&gt;FIADE() bridge { 1e-6 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DFY_3"></a><b><big><tt>Pa_DFY[3]</tt></big></b> -
Insertion mole quantity for a major species in a solution at
Simplex()-&gt;FIADE() bridge { 1e-6 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DFY_4"></a><b><big><tt>Pa_DFY[4] </tt></big></b>-
Insertion mole quantity for a junior species in a solution at
Simplex()-&gt;FIADE() bridge{ 1e-6 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DFY_5"></a><b><big><tt>Pa_DFY[5]</tt></big></b> -
Insertion mole quantity for a single-component phase at
Simplex()-&gt;FIADE() bridge { 1e-6 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_DFY_6"></a><b><big><tt>Pa_DFY[6]</tt></big></b>
-&nbsp;Insertion mole quantity for a single-component phase in
PhaseSelect() { 1e-7 }</dt>
  <dd>&nbsp;</dd>
  <dd>&nbsp; &nbsp;<br>
  </dd>
  <dt> <a name="Pa_EPS_0"></a><big><b><tt>Pa_EPS[0]</tt></b></big> -
Tolerance of the Simplex() method convergence{ 1e-6 to 1e-14 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This criterion defines the precision of Simplex() initial
approximation.&nbsp;</dd>
  <dd>Usually, it should be set to 1e-7 mol; in rare cases, higher
precision may be required.&nbsp;</dd>
  <dd>&nbsp;&nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_EPS_1"></a><big><b><tt>Pa_EPS[1]</tt></b><small> -</small></big>
Tolerance for calculation of surface activity terms for surface species
{ 1e-3 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This is an experimental value for smoothing bad numerical
behavior of SACT at high surface coverages. In most cases, the value of
1e-3 should be used.<br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_GAN_0"></a><big><b><tt>Pa_GAN[0] </tt></b><small><small><tt>-</tt></small></small></big>Initial
activity coefficient value for major species in a solution phase at
Simplex()&nbsp; { 1 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_GAN_1"></a><big><b><tt>Pa_GAN[1] - </tt></b></big>Initial
activity coefficient value for minor species in a solution phase at
Simplex() { 1000 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This control is important if highly non-ideal solution phases are
involved that may potentially produce miscibility gaps.&nbsp;</dd>
  <dd>This value will be automatically used at Simplex() calculation
only as an activity coefficient for any soultion end-member marked as
"junior" (J code in Phase definition) expected to appear in much
smaller mole fraction than the "major" (M) end-member (see above). In
addition, the same operation is performed at Simplex() for surface
complexes in sorption phases.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Possible values of this control: &nbsp;from 10 to 10000, default
1000, recommended values are between 100 and 1000.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_GAN_2"></a><big><b><tt>Pa_GAN[2]</tt></b></big> -
&nbsp;IPM-2 precision control factor DHBM[i]/b[i] in FIADE2()
procedure { 0.001 }</dt>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp;This factor defines the values of individual thresholds for
mass balance residuals for trace independent components on entering the
high-precision loops of the IPM-2 algorithm. If set to 0.001, the
FIADE-2() thresholds will require that the corresponding residuals not
exceed 0.1% of the total mole quantity of the independent component in
the system. <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>Possible values: 0.0001 to 0.1 (default 0.001). &nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_DG"></a><b><big><tt>Pa_DG</tt></big></b> -
Precision
tolerance of LEM IPM solver (Jordan) { 1e-30 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This control is obsolete and will probably be removed in next
versions of the program. &nbsp;</dd>
  <dd><br>
  </dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DPV_0"></a><big><big><b><tt>Pa_DPV[0]</tt></b></big></big>
- Maximal number of iterations in EntryFeasibleDomain() procedure { 100
}</dt>
  <dd> &nbsp;</dd>
  <dd>This control defines a maximum number of EFD() iterations that,
when
reached, declares that the procedure did not converge and the IPM
feasible domain cannot be entered at the requested mass balance
precision as defined in the <a href="#Pa_DHB"><tt>Pa_DHB</tt></a>
(DHBM) thresholds. 95 % of chemical systems require 1 to 6 iterations,
some need 300 or more. <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Possible values: 10 to 200, recommended value: 150, default
value: 100.&nbsp;</dd>
  <dd>&nbsp;&nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_DPV_1"></a><big><b><big><tt>Pa_DPV[1]</tt></big></b></big>
- Maximum number of allowed IPM-2 balance precision improvement loops {
15 }</dt>
  <dd> <br>
  </dd>
  <dd>This control defines &nbsp;how many loops of IPM-2 mass balance
precision
improvement can be executed. Possible values:&nbsp;</dd>
</dl>
<blockquote>
  <dl>
    <dd>0 - &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;disables the IPM-2
precision enhancement;&nbsp;</dd>
    <dd>1 to 15 - &nbsp;enables IPM-2.&nbsp;</dd>
  </dl>
</blockquote>
<dl>
  <dd>Default value: 15 (i.e. 1 initial and up to 14 enhancement IPM-2
loops).&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_DPV_2"></a><big><b><big><tt>Pa_DPV[2]</tt></big></b></big>
- IPM-2 cutoff exponent to restore primal x vector elements using the
dual vector u &nbsp;{ -5 to +2 }</dt>
  <dd><br>
  </dd>
  <dd>This control defines the cutoff value used to decide whether mole
quantities of trace species in the primal solution vector x should be
replaced with values calculated using the dual solution vector u.
Possible values:</dd>
  <dd>from -5 to +2 relative to DHBM value. Default exponent is
-2. Recommended value is 0. <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Example: value of -2 means that all values in the x vector less
than DHBM * 10^-2 will be replaced with the DualT-calculated values.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp; &nbsp;<br>
  </dd>
  <dt> <a name="Pa_LLG"></a><big><big><b><tt>Pa_LLG</tt></b></big></big>
- IPM-2 tolerance for checking change in dual solution among refinement
loops { 0 to 1000 }</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Possible values: <br>
  </dd>
</dl>
<blockquote>
  <dl>
    <dd> 0 - no check (is set internally to 32000 units to retain
compatibility with older projects created ib GEMS v.2.2.4 or earlier)</dd>
    <dd>1 to 1000 - if an element of the dual solution vector u has
changed in the magnitude more than in Pa_LLG units (of dimensionless
chemical potential) between refinement loops then the alert condition
is raised. In SIA mode, this will cause the calculation of this
equilibrium in AIA (simplex) mode. In the AIA mode, the warning W14IPM
will be generated.&nbsp; &nbsp; <br>
    </dd>
  </dl>
</blockquote>
<dl>
  <dd>Default value: 0 (32000). <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DF_0"></a><big><big><b><tt>Pa_DF[0]</tt></b></big></big>
- Threshold for Karpov's criterion (Fa &gt; DF) for a lost stable phase
to be inserted {
0.01
}</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This numerical threshold is used in the PhaseSelect()
function to check stability of all pure (single-component) phases
absent from the system mass balance after
the main cycle of IPM iterations has converged. Theoretically, if a
phase is stable and present in some non-zero amount, then its Karpov
stability criterion Fa = 0.
Numerically, it is satisfied with some deviation
because of limited precision of mass balance and inconsistency of
thermodynamic data.</dd>
  <dd>&nbsp;</dd>
  <dd>In principle, two cases of inconsistency are possible. <br>
  </dd>
  <dd>(1) The Karpov criterion Fa &gt; DF but the amount of phase Xa =
0 (phase is stable but absent from the mass balance).</dd>
  <dd>(2) The Karpov criterion Fa &lt; -DFM but the amount of phase Xa
&gt; 0 (phase is unstable but present in the mass balance). &nbsp; <br>
  </dd>
</dl>
<dl>
  <dd>Hence, the Pa_DF[0] threshold defines the maximum tolerance for
the case (1). If this is the case and the phase dependent component has
trivial metastability constraints (0 from below and 1e6 from above)
then the PhaseSelekt() will insert this DC in the amount defined in the
    <a style="font-family: monospace;" href="#Pa_DFY_6">Pa_DFY[6]</a>
field (usually 1e-7 mol). Thus modified GEM primal solution will be
used as a new initial approximation for the next IPM loop. Up to 3 such
loops can be performed. If the situation persists then the stability
and/or stoichiometry of this phase has to be checked. Another reason
could be that other relevant components/phases for this chemical
element are not present in the chemical system definition and must be
inserted. <br>
  </dd>
  <dd><br>
  </dd>
  <dd>Recommended value: 0.01.</dd>
  <dd><br>
  </dd>
  <dd>See the <span style="font-family: monospace;">Pa_DF[1]</span>
field below for explanation of the inconsistency case (2).&nbsp; <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_DF_1"></a><big><big><b><tt>Pa_DF[1]</tt></b></big></big>
-
Threshold for Karpov's criterion (Fa &lt; -DFM) for a present unstable
phase to be eliminated { 0.1 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This numerical threshold is used in the PhaseSelect()
function to check stability of all pure (single-component) phases
present in the system mass balance after
the main cycle of IPM iterations has converged. Theoretically, if a
phase is stable and present in some non-zero amount, then its Karpov
stability criterion Fa = 0.
Numerically, it is satisfied with some deviation
because of limited precision of mass balance and inconsistency of
thermodynamic data.</dd>
  <dd><br>
  </dd>
  <dd>In principle, two cases of inconsistency are possible. <br>
  </dd>
  <dd>(1) The Karpov criterion Fa &gt; DF but the amount of phase Xa =
0 (phase is stable but absent from the mass balance).</dd>
  <dd>(2) The Karpov criterion Fa &lt; -DFM but the amount of phase Xa
&gt; 0 (phase is unstable but present in the mass balance). &nbsp; </dd>
  <dd><br>
  </dd>
  <dd>Hence, the Pa_DF[1] threshold defines the maximum tolerance for
the
case (2). If this is the case and the phase dependent component has
trivial metastability constraints (0 from below and 1e6 from above)
then the PhaseSelekt() will zero off the amounts of this DC and
phase.Thus modified GEM primal solution will be used as a new initial
approximation for the next IPM loop. Up to 3 such loops can be
performed. If the situation persists then the stability and/or
stoichiometry of this phase has to be checked and eventually corrected.
Sometimes it may be sufficient to set a smaller <a
 style="font-family: monospace;" href="#Pa_DS">Pa_DS</a>
threshold.&nbsp; <br>
  </dd>
  <dd><br>
  </dd>
  <dd>Recommended values: 0.1 or 0.01.&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>See the <span style="font-family: monospace;">Pa_DF[0]</span>
field above for explanation of the inconsistency case (1).&nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_DNS"></a><big><b><tt>Pa_DNS</tt></b></big> -
&nbsp;Default reference density of surface species at standard state {
12.05 nm-2 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;Set 12.05 in this test version (as defined in Kulik,
2002).&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_DK"></a><big><big><b><tt>Pa_DK</tt></b></big></big>
-
Tolerance threshold for the Dikin's criterion of IPM convergence { 1e-4
}</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This important criterion is used to decide whether the IPM
minimization has converged.</dd>
  <dd>Possible values: 1e-3 to 1e-6, 1e-4 is recommended.&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>The criterion is given here for systems of approximately 1 kg
mass. Internally, it will be automatically corrected if the system is
much larger of much smaller (see Chudnenko et al., 2002).&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>Inconsistent thermodynamic data may require to increase DK even
for a small system, otherwise convergence may not be
achieved. However, at such high DK values, incorrect results may be
obtained. Too low tolerance threshold may dramatically increase the
number of IPM iterations and worsen the accuracy of GEM primal
solution. <br>
  </dd>
  <dd>&nbsp;</dd>
  <dd> <br>
  </dd>
  <dt> <a name="Pa_IIM"></a><big><big><b><tt>Pa_IIM</tt><small><small>&nbsp;
- </small></small></b></big></big>Maximum allowed number of
iterations in the IPM-2 task { 400 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Contains maximum number of total IPM algorithm iterations
(including IPM-2 loops). If this number is exceeded, the program
assumes that convergence is not achieved and IPM minimization failed.
Recommended values: 200 to 500, default value is 400. Convergence also
depends on selected <a href="#Pa_DK"><tt>Pa_DK</tt></a> value.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>Usually, IPM converges in 30 to 130 iterations from Simplex()
automatic initial approximation and in 0 to 30 iterations if a previous
IPM results were used as an initial approximation. Note that in the
last case, correctness of IPM results are not guaranteed if the input
bulk composition or temperature were significantly changed.&nbsp;</dd>
  <dd>&nbsp;&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_AG"></a><big><big><b><tt>Pa_AG</tt></b></big></big>
-
Smoothing parameter for increments of chemical potentials cj between
IPM
iterations { 0.7 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This is an initial value for the smoothing parameter which
controls increments of excess chemical potentials of the non-ideal
species between iterations of the IPM. After ca. 50th iteration, the
value of smoothing parameter will be decreased depending on <tt>Pa_DGC</tt>
value.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>Possible values: 1.0 to 0.1. For ideal systems, 1.0 is
recommended. Default value is 0.7.&nbsp;</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_DGC"></a><big><b><big><tt>Pa_DGC</tt></big></b></big>
- &nbsp;Exponent in the sigmoidal smoothing function { 0.07 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This parameter controls how strongly the smoothing parameter (see
above) will be decreased as function of the number of performed IPM
iterations. Possible values:&nbsp;</dd>
</dl>
<blockquote>
  <dl>
    <dd>0 (smoothing is disabled if also <tt>Pa_AG</tt> is set to 1);<br>
    </dd>
    <dd>0.01 to 0.1 to enable smoothing.&nbsp;</dd>
  </dl>
</blockquote>
<dl>
  <dd>Default value: 0.07. <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_PE"></a><big><big><b><tt>Pa_PE</tt></b></big></big>
-
Include electroneutrality condition? { 0 1 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Possible values: 1 - electroneutrality balance equation is
included (required for systems containing aqueous electrolyte,
adsorption or plasma); 0 - charge balance is excluded from the GEM
problem formulation. The program can change this flag automatically if
e.g. the aqueous phase has been eliminated during the IPM descent.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt><a name="Pa_PC"></a><big><b><big><tt>Pa_PC</tt></big></b></big> -
Mode of PhaseSelect() operation &nbsp;{ 1 }</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This flag defines the behavior of PhaseSelect() procedure.&nbsp;</dd>
  <dd>It should be fixed to 1 in the present version of GEM-Selektor.</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Pa_PRD_0"></a><big><b><tt>Pa_PRD[0]</tt></b></big> -
Mode of execution of the built-in DebyeHueckel() / Davies() functions
&nbsp;</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;Possible values: 0-inactive;1-at FIADE() only, 2-after the
IPM has converged; 3- at every IPM iteration.</dd>
  <dd>&nbsp;This switch should be fixed to 3 in the present version of
GEM-Selektor.</dd>
  <dd>&nbsp; &nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="Pa_PRD_1"></a><b><big><tt>Pa_PRD[1]</tt></big></b>
-&nbsp; If negative: number of additional refinement loops for highly
non-ideal systems (-1 to -50, 7 to 14 recommended); if 0 or positive,
additional refinement loops are not done. <br>
  </dt>
  <dd> &nbsp; <br>
In highly non-ideal systems (e.g. containing solvi), it has been found
(by Th.Wagner, University of Tubingen, Germany) that the GEM IPM may
not converge to exact solution after one full cycle with the Simplex
(automatic) initial approximation. However, several&nbsp; additional
runs without Simplex improve the primal solution and reproduce solvi
exactly. This switch allows the user to set up the number of such
additional loops that are automatically executed within a GEM
calculation of the equilibrium state. We recommend setting up the
smallest possible number of additional loops that yields the exact
primal solution (e.g.&nbsp; -7).&nbsp; &nbsp; <br>
  </dd>
  <dd><br>
  </dd>
  <dd>Obsolete values: Possible codes: 0-inactive, 1-FIADE() only, 2-in
PhaseSelect() only; 3-
at every IPM iteration.<br>
  </dd>
  <dd>This code should be fixed to 3 in the present version of
GEM-Selektor.</dd>
  <dd><i>&nbsp;&nbsp;&nbsp;</i></dd>
  <dd><i><br>
    </i></dd>
  <dt> <a name="Pa_PRD_2"></a><b><big><tt>Pa_PRD[2]</tt></big></b> -
Mode of setting activity coefficients at Simplex() approximation&nbsp;</dt>
  <dd> &nbsp; </dd>
  <dd>Possible values: 0-off; 1 - set initial activity coefficients as
described in <a href="#Pa_GAN_0"><tt>Pa_GAN[0]</tt></a> and <a
 href="#Pa_GAN_1"><tt>Pa_GAN[1]</tt></a> fields.&nbsp;</dd>
  <dd>If this switch is set to 0 then all initial activity coefficients
will be 1. Default value: 1. </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pa_DKI"></a><big><b><tt>Pa_DKI</tt></b></big> -
Distance
between two-side kinetic restrictions for primal vector x elements,
moles { 0.001 }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; Reserved for future versions of the GEM-Selektor code. <br>
  </dd>
</dl>
<tt><br>
<br>
</tt>
<hr size="2" width="100%"><tt><br>
</tt>
<h2><a name="IPM_ERRORS"></a>4. Warnings and Error Messages</h2>
<tt><br>
&lt;to be added in Version 2.1&gt;<br>
<br>
<br>
<br>
</tt>
<hr size="2" width="100%"><tt><br>
</tt> &nbsp;&nbsp; <tt><a href="index.html">To Contents</a> &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;<a href="g_about.html">About GEM-Selektor</a>
</tt><br>
<tt><br>
</tt><tt><br>
end of file</tt> <br>
<br>
<br>
<br>
<br>
<br>
<br>
</body>
</html>
